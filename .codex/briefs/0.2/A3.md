# A3 Alignment Brief

## Intent
- Provide **shared** conformance vectors that exercise L0 semantics identically in TS and Rust.
- Make vectors validate **delta NF**, **effects NF**, **lens pointer rules**, and **final-state-in-r0** semantics.

## Derived Constraints (binding)
- `"bytecode.version": "L0"`.
- Regions MUST be RFC6901 JSON Pointers (e.g., "/legal/clauses").
- Final state MUST be in register 0 at HALT; delta computed as null | { replace: regs[0] }.
- Effects NF must list **sorted unique** arrays; external is a list of tf://… if used.
- No floats in any literal; any non-int in `value` must be represented as string if needed.
- If no state change, expected.delta MUST be null.

## Invariants & Oracles
- `lens_update` writes to "/legal/clauses" with array payload; expected.delta equals the replaced state.
- `snapshot_determinism` makes two snapshots on identical state; delta is null; effect has read "/" only.
- `match_assert` calls eq-tf and ASSERTs; no state change; delta null; external includes eq tf.
- `journal_record` produces before/after snaps and uses explicit `{replace:…}` delta.

## Checklist for Coder
- [ ] All vectors conform to the above
- [ ] JSON validates
- [ ] No "legal.clauses"; only "/legal/clauses"
- [ ] r0 holds final state on HALT

## Lessons referenced
- A1: canonicalization; float rejection; -0→0
- A2: canonical snapshot hashing; VM hash paths via canonical bytes
