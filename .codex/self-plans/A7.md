# Self-Plan for A7

## Step-by-step edits
1. **TS ops**
   - Add `packages/tf-lang-l0-ts/src/ops/` with modules:
     - `dimension_eq.ts`: assert two arrays have equal length; throw `E_DIMENSION_MISMATCH` on mismatch.
     - `lens_mod.ts`: compute `((x % m) + m) % m`; reject `m <= 0`.
     - `bounds.ts`: ensure integer within `{min?, max?, inclusive?}`; error `E_BOUNDS` with offending value.
     - `delta_bounded.ts`: verify `|x_t - x_{t-1}| <= B` for each adjacent pair; include `{index, delta}` on failure.
     - `saturate.ts`: clamp integer to `[min,max]`; return clamped value.
   - Add `index.ts` exporting a map from tf ids to functions.
2. **TS host**
   - Update `packages/tf-lang-l0-ts/src/host/memory.ts` `call_tf` to delegate to ops map and return results.
3. **Rust ops**
   - Mirror modules under `packages/tf-lang-l0-rs/src/ops/` implementing the same behavior with `serde_json::Value`.
   - Expose `pub mod ops;` in `packages/tf-lang-l0-rs/src/lib.rs`.
4. **Rust test host**
   - Update `packages/tf-lang-l0-rs/tests/vectors.rs` `DummyHost::call_tf` to match new `tf://â€¦@0.1` ids and invoke ops.
5. **Vectors**
   - Add `tests/vectors` cases exercising each op: `dimension_eq.json`, `lens_mod.json`, `bounds.json`, `delta_bounded.json`, `saturate.json`.
   - Each vector asserts success of the op and expected delta/effect.

## Test changes
- Extend vector suite with five new JSON fixtures above.
- Use existing runners: `pnpm -C packages/tf-lang-l0-ts vectors` and Rust `cargo test --manifest-path packages/tf-lang-l0-rs/Cargo.toml`.

## Risks and rollback
- Parity drift between TS and Rust implementations.
- Incorrect integer checks leading to float acceptance.
- If failures arise, revert new ops and vectors or adjust implementations.

## Definition of done
- New ops available in TS and Rust and exposed via host call.
- New vectors pass in both TS and Rust runners.
- All existing tests still pass.
- Commands to verify:
  - `pnpm -C packages/tf-lang-l0-ts vectors`
  - `cargo test --manifest-path packages/tf-lang-l0-rs/Cargo.toml`
