# Plan for B2

## Steps
1. Add proof tag sink to TS and Rust runtime modules that collects tags only when `DEV_PROOFS=1`.
2. Emit proof tags from VM interpreters:
   - Witness + Normalization at run end using final delta/effect.
   - Transport on `LENS_PROJ`/`LENS_MERGE`.
   - Refutation before `ASSERT` failure.
   - Conservativity when `CALL` boundary errors.
3. Expose helper to retrieve and clear collected tags for tests.
4. Write unit tests in TS and Rust verifying:
   - Tags appear with `DEV_PROOFS=1` and include witness, transport, refutation, and conservativity cases.
   - No tags emitted when flag unset.
5. Update LESSONS and append to JOURNAL.

## Tests
- `pnpm -C packages/tf-lang-l0-ts test`
- `pnpm -C packages/tf-lang-l0-ts vectors`
- `cargo test --manifest-path packages/tf-lang-l0-rs/Cargo.toml`

## Risks
- Global sinks causing cross-test contamination if not cleared.
- Environment gating logic may differ across runtimes.
- Error shapes for conservativity may be oversimplified.

## Definition of Done
- VM emits specified proof tags only when `DEV_PROOFS=1`.
- Unit tests cover presence/absence and error cases for TS and Rust.
- LESSONS and JOURNAL updated, working tree clean.
