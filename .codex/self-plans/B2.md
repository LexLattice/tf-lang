# Plan for Task B2

## Steps
1. Add proof logging modules in TS and Rust that capture tags only when `DEV_PROOFS=1`.
2. Instrument TS VM to emit Transport tags on lens ops, Conservativity on null CALL results, Refutation on failed ASSERT, and Witness/Normalization after run.
3. Mirror these emissions in the Rust VM.
4. Expose log/take helpers for tests.
5. Write unit tests in TS and Rust verifying tags appear when `DEV_PROOFS=1` and remain absent otherwise.
6. Run `pnpm -C packages/tf-lang-l0-ts test`, `pnpm -C packages/tf-lang-l0-ts vectors`, and `cargo test --manifest-path packages/tf-lang-l0-rs/Cargo.toml`.
7. Append journal entry and update lessons if a new rule emerges.

## Test Changes
- `pnpm -C packages/tf-lang-l0-ts test`
- `pnpm -C packages/tf-lang-l0-ts vectors`
- `cargo test --manifest-path packages/tf-lang-l0-rs/Cargo.toml`

## Risks & Rollback
- Divergent behavior between TS and Rust emissions.
- Forgetting to clear logs may cause flaky tests.
- Emissions accidentally affecting normal runtime.
- Rollback by removing proof logging modules and reverting VM changes.

## Definition of Done
- Tags emitted only when `DEV_PROOFS=1` and cover Witness, Normalization, Transport, Refutation, and Conservativity cases.
- All tests and vectors pass.
- Journal updated; new lesson added if warranted.
