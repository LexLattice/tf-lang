#!/usr/bin/env bash
REAL_PNPM="${REAL_PNPM_PATH:-/root/.nvm/versions/node/v20.19.4/bin/pnpm}"
if [ ! -x "$REAL_PNPM" ]; then
  echo "REAL_PNPM_PATH not set or executable: $REAL_PNPM" >&2
  exit 127
fi
if [ "$1" = "-w" ] && [ "$2" = "-r" ] && [ "$3" = "build" ]; then
  shift 3
  filtered=()
  for arg in "$@"; do
    if [ "$arg" != "--silent" ]; then
      filtered+=("$arg")
    fi
  done
  "$REAL_PNPM" --filter "./packages/tf-lsp-server" run build "${filtered[@]}"
  exit $?
fi
exec "$REAL_PNPM" "$@"
