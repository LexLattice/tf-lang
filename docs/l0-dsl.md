<!-- generated by scripts/docgen/dsl.mjs; do not edit by hand; sha256:efc74010877c25bc9fc0496321d62f032a8deccf9332d2eada5b4e91b9f7474d -->
# L0 DSL Cheatsheet (generated)

## Basics

- `step |> next` composes primitives left-to-right.
- `seq{ ... }` groups statements sequentially; semicolons separate explicit steps.
- `par{ ... }` evaluates children in parallel; wrap multiple steps with semicolons.
- Identifiers map to primitives and are normalized to lowercase during parsing.

## Args & Literals

- Strings support single or double quotes with standard escape handling.
- Numbers accept integers and decimals with optional leading minus.
- Boolean literals `true` and `false` are parsed as actual booleans.
- `null` produces a JavaScript null literal.
- Array literals use `[value, ...]` with trailing commas supported.
- Object literals use `{ key: value, ... }` and accept string, identifier, or numeric keys.
- Argument lists appear as `prim(arg=value, ...)` and default to an empty object when omitted.

## Regions

- `authorize{ ... }` wraps a region; optional `authorize(attrs){ ... }` attaches metadata.
- `txn{ ... }` models transactional regions with optional attributes like `txn(scope="ledger"){ ... }`.

## Comments

- The tokenizer does not implement comment skipping; treat `#`, `//`, or `/* */` as syntax errors and keep flows comment-free.

## CLI usage

| Command | Summary |
| --- | --- |
| `tf parse` | Parse a `.tf` file and emit canonical IR JSON. |
| `tf check` | Validate a flow against the catalog and region policies, returning JSON verdicts. |
| `tf canon` | Normalize a parsed flow using effect laws for deterministic ordering. |
| `tf emit` | Generate code for the requested language (TypeScript or Rust) under `out/`. Use `--lang ts|rs` and optionally `--out` for the destination. |

## Examples

### auth_missing.tf

```tf
sign-data(key="k1")
```

### auth_ok.tf

```tf
authorize(scope="kms.sign"){ sign-data(key="k1") }
```

### auth_wrong_scope.tf

```tf
authorize(scope="kms.decrypt"){ sign-data(key="k1") }
```

### emit_commute.tf

```tf
emit-metric(key="ok") |> hash
```

### info_roundtrip.tf

```tf
serialize |> deserialize
```

### manifest_publish.tf

```tf
publish(topic="orders", key="abc", payload="{}")
```

### net_publish.tf

```tf
authorize{ publish(topic="orders", key="abc", payload="{}") }
```

### obs_pure_EP.tf

```tf
emit-metric |> hash
```

### obs_pure_PE.tf

```tf
hash |> emit-metric
```

### run_publish.tf

```tf
authorize{ publish(topic="events", key="event-1", payload="{}") }
```

### signing.tf

```tf
serialize |> hash |> authorize{ sign-data(key_ref="k1") }
```

### txn_fail_missing_key.tf

```tf
txn{
  write-object(uri="res://kv/bucket", key="x", value="1")
}
```

### write_outside_txn.tf

```tf
write-object(uri="res://kv/bucket", key="z", value="3")
```
