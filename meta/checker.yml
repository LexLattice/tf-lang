version: 1
allow_paths:
  - "packages/tf-lsp-server/**"
  - "packages/tf-compose/src/**"
  - "packages/tf-run-wasm/**"
  - "packages/tf-opt/**"
  - "tools/tf-lsp-sample/**"
  - "tools/tf-lang-cli/**"
  - "meta/**"
  - "tf/blocks/A1-LSP-Proto/**"
  - "tf/blocks/A4-DSL-Ergonomics/**"
  - "tf/blocks/B1-B2-Runtime/**"
  - "tf/blocks/D1-D2-Optimizer/**"
  - "tf/blocks/E1-E2-Proofs/**"
  - "scripts/lsp-smoke/**"
  - "scripts/wasm/**"
  - "scripts/opt/**"
  - "scripts/proofs/**"
  - "clients/vscode-tf/**"
  - "crates/tf-eval-core/**"
  - "crates/tf-eval-wasm/**"
  - "samples/a1/**"
  - "samples/a4/**"
  - "samples/b1/**"
  - "samples/d1/**"
  - "samples/e1/**"
forbid_paths:
  - "packages/tf-optimize/**"
  - "crates/**"
  - "**/*.generated.*"
  - "clients/vscode-tf/dist/**"
  - "pnpm-workspace.yaml"
  - "package.json"

token_rules:
  - id: ts_any_type
    desc: "TypeScript ': any'"
    include: ["**/*.ts","**/*.tsx"]
    exclude: ["**/*.d.ts","**/__tests__/**","**/test/**"]
    pattern: ":\\s*any\\b"
    severity: block
  - id: ts_as_any
    desc: "TypeScript 'as any'"
    include: ["**/*.ts","**/*.tsx"]
    pattern: "\\bas\\s+any\\b"
    severity: block
  - id: js_eval
    desc: "eval()"
    include: ["**/*.js","**/*.ts","**/*.tsx"]
    pattern: "\\beval\\s*\\("
    severity: block
  - id: ts_ignore
    desc: "@ts-ignore"
    include: ["**/*.ts","**/*.tsx"]
    pattern: "@ts-ignore"
    severity: warn
  - id: ts_expect_error
    desc: "@ts-expect-error is not allowed in added lines"
    include: ["**/*.ts","**/*.tsx"]
    pattern: "@ts-expect-error"
    severity: warn

  - id: forbid_vscode_dist
    desc: "Do not commit clients/vscode-tf/dist/** (built artifacts)"
    include: ["clients/vscode-tf/dist/**"]
    pattern: ".*"
    severity: error


strict: false
