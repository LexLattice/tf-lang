# TF-Lang v0.6: Documentation & DX Review — Executive Brief

This review covers the full v0.6 plan (Tracks A–H) to identify friction points and prioritize polish before the release. The system shows significant progress in its core logic, but is hampered by critical gaps in release readiness, documentation, and developer experience.

## Top 7 Gaps & Recommendations

| Rank | Gap / Theme | Severity | Tracks | Suggested Owner | Effort |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | **Critical Correctness & Security Gaps** | **S1** | E, H | Prover Lead | L |
| 2 | **Broken Onboarding & Example Workflow** | **S1** | A, D | Platform Lead | M |
| 3 | **Widespread Documentation Deficiencies** | S2 | A-H | All Leads | L |
| 4 | **Poor CLI Discoverability & Ergonomics** | S2 | A, B, C, G | Platform Lead | M |
| 5 | **Code Duplication & Architectural Hazards** | S1-S2 | B, C, D | Engine/Runtime Leads | M |
| 6 | **Incomplete v0.6 Feature Implementation** | S2 | E, F, G | Engine Lead | M |
| 7 | **Lack of Visualization & Debugging Tools** | S2-S3 | G, H | Platform/Prover Leads| M |

---

### 1. Critical Correctness & Security Gaps (S1 - Release Blocker)

The prover and law-checking system, a headline feature of v0.6, is not functioning as expected. This is the most severe issue and blocks the release.

*   **The Problem**:
    *   The law checker is disconnected from the L0 files it's meant to analyze. It runs static, hardcoded samples instead of verifying the algebraic laws attached to the actual nodes in a pipeline. (Track E)
    *   Advanced prover checks for `monotonic_log` and `confidential_envelope` are shallow pattern matches, not deep proofs, providing a false sense of security. (Track H)
*   **Business Impact**: We risk shipping a system that claims formal verification but doesn't perform it, undermining user trust and core value props.
*   **Recommendation**: **Fix the law-checking system to be dynamic and deepen the prover logic.** This is a large but non-negotiable effort.
    *   **Owner**: Prover Lead
    *   **Effort**: Large

### 2. Broken Onboarding & Example Workflow (S1 - Release Blocker)

A new contributor's first five minutes with the repository result in failure and confusion.

*   **The Problem**:
    *   The main example script (`tasks/run-examples.sh`) is broken out of the box due to a fragile YAML parser. (Track D)
    *   The root `README.md` is outdated, referencing v0.5 examples and commands. (Track A)
*   **Business Impact**: Inability to onboard new developers or allow users to successfully try the product.
*   **Recommendation**: **Fix the example script and update the root README.** The immediate fix is small (remove a comment), but the underlying parser fragility should be addressed.
    *   **Owner**: Platform Lead
    *   **Effort**: Medium

### 3. Widespread Documentation Deficiencies (S2)

Core concepts, workflows, and extension points are undocumented across all tracks.

*   **The Problem**: No central `CONTRIBUTING.md`; no v0.6 specification; no documentation for the instance registry, port typing syntax, Z3 prover integration, or macro extension process.
*   **Business Impact**: Lowers development velocity, increases reliance on original authors, and makes community contributions impossible.
*   **Recommendation**: **Initiate a documentation push focused on creating "first-try successful" guides** for core tasks: contributing, adding a macro, and using the instance planner.
    *   **Owner**: All Leads
    *   **Effort**: Large

### 4. Poor CLI Discoverability & Ergonomics (S2)

Core engine functions are hidden, and user-facing commands are clumsy.

*   **The Problem**: No direct CLI commands for L2->L0 expansion or L0 execution. Commands are verbose (`node path/to/script.mjs`) due to broken aliases. Tools lack human-readable output formats.
*   **Business Impact**: High friction for local development and debugging cycles.
*   **Recommendation**: **Expose core functions via the CLI** (`tf expand`, `tf run`) and fix the alias setup. Add table-based, human-readable formats to `plan-instances` and `checker`.
    *   **Owner**: Platform Lead
    *   **Effort**: Medium

### 5. Code Duplication & Architectural Hazards (S1-S2)

Key components have significant architectural flaws that impact correctness and maintainability.

*   **The Problem**: The runtime (`run.mjs`) duplicates all transform logic from `transform/index.mjs`, creating a critical risk of divergence. The YAML macro parser is a fragile regex-based hack.
*   **Business Impact**: High risk of subtle bugs and increased maintenance cost.
*   **Recommendation**: **Refactor the runtime to import (not duplicate) the transform logic.** Replace the YAML pre-processor with standard block scalars.
    *   **Owner**: Engine/Runtime Leads
    *   **Effort**: Medium

### 6. Incomplete v0.6 Feature Implementation (S2)

Key features scoped for v0.6 are either missing or incomplete.

*   **The Problem**: `auth.*` macros are not implemented in the expander. The capability lattice is missing definitions for channels used in the examples. There is no way to embed instance hints in source files.
*   **Business Impact**: The release will not meet its specified feature set.
*   **Recommendation**: **Implement the missing `auth` macros and complete the capability lattice.** Defer instance hints in source files if necessary, but update the track name to reflect this.
    *   **Owner**: Engine Lead
    *   **Effort**: Medium

### 7. Lack of Visualization & Debugging Tools (S2-S3)

It is difficult to "see" what the system is doing.

*   **The Problem**: No way to visualize the physical instance plan on the DAG. The Z3 prover is a black box with no debug output.
*   **Business Impact**: Slows down debugging and makes it hard for operators to understand deployment topology.
*   **Recommendation**: **Enhance `tf graph` to visualize instance plans.** Add a `--debug-prover` flag to `tf laws` to dump SMT-LIB scripts.
    *   **Owner**: Platform/Prover Leads
    *   **Effort**: Medium